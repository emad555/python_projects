if (self.CavalryLogger) { CavalryLogger.start_js(["dRvUF"]); }

__d("FBRTCSoundController",["RTCConfig","RTWebUserActionLogger","Sound"],(function(a,b,c,d,e,f){var g=[(a=b("RTCConfig")).ringtone_mp3_url,a.ringtone_ogg_url],h=[a.ringback_mp3_url,a.ringback_ogg_url];c={playIncomingRingtone:function(a,c,d){var e=d.loop,f=d.isP2P;d=d.isUnsupportedDialog;d=d===void 0?!1:d;c=["incoming_ringtone",a.toString(),c].join("_");b("Sound").play(g,c,e);b("RTWebUserActionLogger").logEvent({callID:a.toString(),callType:f?"p2p":"mw",component:"incoming_ring_tone",eventName:"ring_tone_played",surface:d?"missed_call_dialog":"incoming_call_dialog"})},stopIncomingRingtone:function(){b("Sound").stop(g)},playRingbackTone:function(){b("Sound").play(h,null,!0)},stopRingbackTone:function(){b("Sound").stop(h)}};e.exports=c}),null);
__d("XIncomingCallDialogController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/incoming/",{user_id:{type:"FBID",required:!0},call_id:{type:"Int"},dialog_type:{type:"String",defaultValue:"VIDEO"},__asyncDialog:{type:"Int"}})}),null);
__d("FBRTCIncomingCallDialog",["AsyncDialog","AsyncRequest","Dialog","EventEmitter","FBRTCConstants","FBRTCSoundController","XIncomingCallDialogController","clearTimeout","setTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){var g=7e4;a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(b,c){var d;d=a.call(this)||this;d.peerID=b;d.callID=c;d.$FBRTCIncomingCallDialog2=!1;d.$FBRTCIncomingCallDialog1=null;return d}c.getCallEndReasonForNewRequest=function(){return null};var d=c.prototype;d.showIncomingDialog=function(a){var c=b("Dialog").getCurrent();c&&c.hide();c=b("XIncomingCallDialogController").getURIBuilder().setFBID("user_id",this.peerID).setInt("call_id",this.callID).setString("dialog_type",a).getURI();this.$FBRTCIncomingCallDialog1=new(b("AsyncRequest"))(c);this.$FBRTCIncomingCallDialog2=a===b("FBRTCConstants").IncomingCallDialogTypes.VIDEO;b("AsyncDialog").send(this.$FBRTCIncomingCallDialog1,this.$FBRTCIncomingCallDialog3.bind(this))};d.$FBRTCIncomingCallDialog3=function(a){if(!this.$FBRTCIncomingCallDialog1){b("setTimeout")(function(){a.hide()},1);return}this.$FBRTCIncomingCallDialog1=null;this.view=a;a.subscribe("confirm",this.$FBRTCIncomingCallDialog4.bind(this));a.subscribe("cancel",this.$FBRTCIncomingCallDialog5.bind(this));b("FBRTCSoundController").playIncomingRingtone(this.callID,this.peerID,{loop:!0,isP2P:!0});this.timeout=b("setTimeoutAcrossTransitions")(this.$FBRTCIncomingCallDialog6.bind(this),g)};d.cancel=function(){this.$FBRTCIncomingCallDialog1&&(this.$FBRTCIncomingCallDialog1.abort(),this.$FBRTCIncomingCallDialog1=null),this.timeout&&b("clearTimeout")(this.timeout),this.view&&(this.view.hide(),this.view=null),b("FBRTCSoundController").stopIncomingRingtone()};d.isForPeer=function(a){return this.peerID===a};d.isForCall=function(a){return this.callID===a};d.isForPeerAndCall=function(a,b){return this.peerID===a&&this.callID===b};d.$FBRTCIncomingCallDialog4=function(){this.cancel(),this.emit("answerCall",this.callID,this.$FBRTCIncomingCallDialog2)};d.$FBRTCIncomingCallDialog5=function(){this.cancel(),this.emit("ignoreCall",!1)};d.$FBRTCIncomingCallDialog6=function(){this.cancel(),this.emit("timeout",!1)};return c}(b("EventEmitter"));e.exports=a}),null);
__d("XVideoCallMissedCallController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/missed_call/",{user_id:{type:"Int",required:!0},__asyncDialog:{type:"Int"}})}),null);
__d("XVideoCallMissedCallDialogController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/dismiss_all_missed_call_dialog/",{})}),null);
__d("FBRTCMissedVideoCallHandler",["Arbiter","AsyncDialog","AsyncRequest","ChannelConstants","FBRTCCore","FBRTCLogger","FBRTCSupport","XVideoCallMissedCallController","XVideoCallMissedCallDialogController","qex"],(function(a,b,c,d,e,f){var g=null,h=null,i=null;a=function(){"use strict";function a(){this.$1=null}var c=a.prototype;c.hideDialog=function(){g&&(g.hide(),g=null,h=null,i&&(i.unsubscribe(),i=null))};c.onCallMissed=function(a){if(!b("FBRTCSupport").isWebrtcSupported())return;h===null&&(this.$1=a)};c.showDialog=function(a){a&&(this.$2=a);if(!this.$1||h)return;h=this.$1;this.$1=null;a=b("XVideoCallMissedCallController").getURIBuilder().setInt("user_id",h).getURI();a=new(b("AsyncRequest"))(a);b("AsyncDialog").send(a,this.$3.bind(this))};c.$3=function(a){g=a,a.subscribe("confirm",this.$4.bind(this)),a.subscribe("cancel",this.$5.bind(this)),i=b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("dismiss_all_missed_call_dialog"),this.$6.bind(this))};c.$4=function(){h&&(b("qex")._("1277463")?this.$2!=null&&this.$2():b("FBRTCCore").startOutgoingCall(h,b("FBRTCLogger").Trigger.RETURN_CALL,!1)),this.$5()};c.$5=function(){this.hideDialog(),this.$7()};c.$7=function(){new(b("AsyncRequest"))(b("XVideoCallMissedCallDialogController").getURIBuilder().getURI()).send()};c.$6=function(){this.hideDialog()};return a}();e.exports=a}),null);
__d("XBrowserNotSupportedDialogController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/browser_not_supported/",{is_group_call:{type:"Bool",defaultValue:!1},participants:{type:"StringVector"},user_id:{type:"Int"},warning:{type:"Bool",defaultValue:!1},call_type:{type:"Enum",defaultValue:2,enumType:0},__asyncDialog:{type:"Int"}})}),null);
__d("FBRTCUnsupportedBrowserMessage",["requireCond","AsyncDialog","AsyncRequest","FBRTCCallConstants","FBRTCSoundController","MessengerDialogs.re","cr:1453546","React","XBrowserNotSupportedDialogController","ZenonUpsellLinks"],(function(a,b,c,d,e,f){var g=b("FBRTCCallConstants").FBRTCCallType,h=b("React");a={_dialog:null,warnForOutgoingCall:function(a){var c=b("XBrowserNotSupportedDialogController").getURIBuilder().setBool("warning",!0).getURI();this._presentDialog(c,a)},showForOutgoingCall:function(){var a=b("ZenonUpsellLinks").getDesktopUpsellLinkIfEnabledForCalls();if(a!=null&&b("cr:1453546")!=null)b("MessengerDialogs.re").showDialog(function(){return h.jsx(b("cr:1453546"),{desktopAppstoreLink:a,hideDialog:b("MessengerDialogs.re").removeAllDialogs,onUnmount:function(a){a||b("MessengerDialogs.re").removeAllDialogs()}})});else{var c=b("XBrowserNotSupportedDialogController").getURIBuilder().getURI();this._presentDialog(c)}},showForIncomingCall:function(a,c){b("FBRTCSoundController").playIncomingRingtone(a,c,{loop:!1,isP2P:!0,isUnsupportedDialog:!0});var d=b("ZenonUpsellLinks").getDesktopUpsellLinkIfEnabledForCalls();if(d!=null&&b("cr:1453546")!=null)b("MessengerDialogs.re").showDialog(function(){return h.jsx(b("cr:1453546"),{desktopAppstoreLink:d,hideDialog:b("MessengerDialogs.re").removeAllDialogs,incomingUserID:c,onUnmount:function(a){a||b("MessengerDialogs.re").removeAllDialogs()}})});else{a=b("XBrowserNotSupportedDialogController").getURIBuilder().setInt("user_id",c).getURI();this._presentDialog(a)}},showForIncomingGroupCall:function(a,c,d,e){b("FBRTCSoundController").playIncomingRingtone(a,e,{loop:!1,isP2P:!1,isUnsupportedDialog:!0});a=b("XBrowserNotSupportedDialogController").getURIBuilder().setBool("is_group_call",!0).setInt("user_id",d).setStringVector("participants",c).getURI();this._presentDialog(a)},showForOutgoingGroupCall:function(){var a=b("XBrowserNotSupportedDialogController").getURIBuilder().setBool("is_group_call",!0).getURI();this._presentDialog(a)},showForUnsupportedCollabCall:function(){var a=b("XBrowserNotSupportedDialogController").getURIBuilder().setEnum("call_type",g.COLLAB_VIDEO_CALL).getURI();this._presentDialog(a)},showForUnsupportedCollabScreenSharing:function(){var a=b("XBrowserNotSupportedDialogController").getURIBuilder().setEnum("call_type",g.COLLAB_SCREEN_SHARE_CALL).getURI();this._presentDialog(a)},dismiss:function(){this._dialog&&this._dialog.hide()},_presentDialog:function(a,c){var d=this;if(this._dialog)return;a=new(b("AsyncRequest"))(a);b("AsyncDialog").send(a,function(a){d._dialog=a,a.subscribe("hide",function(){d._dialog=null,c&&c()})})}};e.exports=a}),null);
__d("ZenonIncomingCallController",["CurrentUser","FBRTCConstants","MessengerBrowserAlerts","ZenonPreCallHookBuilderHelper","ZenonUserActionLogger"],(function(a,b,c,d,e,f){a=function(){"use strict";function a(a,c,d,e,f){var g=this;this.$9=function(){g.$10(),b("ZenonPreCallHookBuilderHelper").acceptCall(g.$2,"blue_incoming_dialog_accept_button"),b("ZenonUserActionLogger").logClick({component:"accept_button",surface:"incoming_call_dialog"})};this.$1=null;this.$2=a;this.$3=c;this.$4=d;this.$5=null;this.$7=e;this.$6=f}var c=a.prototype;c.onMessageReceived=function(a){var c=this,d;if(a===null)return;switch(a.type){case"ringing":this.$8(a);d=a.context.type==="room"?new this.$4((d=a.controllerParams.callContext)!=null?d:"",parseInt(a.controllerParams.callID,10),a.inviterID,[].concat(a.participants),(d=a.controllerParams.serverInfoData)!=null?d:"",a.context.type==="room"?a.context.room.roomName:"",a.context.type==="room"?a.context.room.linkHash:""):new this.$3(a.inviterID,a.controllerParams.callID);d.addListener("answerCall",this.$9);d.addListener("ignoreCall",function(){c.$10(),c.$2.callInviteModel.decline()});d.addListener("timeout",function(){c.$2.callInviteModel.decline("NoAnswerTimeout"),c.$11(a)});this.$6.hideDialog();this.$7.dismiss();d.showIncomingDialog(a.requestingVideo?b("FBRTCConstants").IncomingCallDialogTypes.VIDEO:b("FBRTCConstants").IncomingCallDialogTypes.AUDIO);this.$5=d;b("ZenonUserActionLogger").logImpression({surface:"incoming_call_dialog"});break;case"missed":this.$11(a);break;case"unsupported_browser":this.$10(),this.$5!=null&&this.$5.cancel(),this.$6.hideDialog(),this.$7.showForIncomingCall(Number(a.controllerParams.callID),a.inviterID)}};c.$8=function(a){var c=this;a={callID:a.controllerParams.callID,peerID:a.inviterID,onNotificationClicked:function(){c.$5!=null&&c.$5.cancel(),b("ZenonPreCallHookBuilderHelper").acceptCall(c.$2,"desktop_notification")},isVideoCall:a.requestingVideo,isGroupCall:!0};b("MessengerBrowserAlerts").showRTCNotification(a,function(a){c.$1=a})};c.$10=function(){this.$1&&(this.$1.close(),this.$1=null)};c.$11=function(a){var c=this;if(a.context.type==="thread"){var d=a.context.thread;this.$10();this.$5!=null&&this.$5.cancel();this.$7.dismiss();this.$6.onCallMissed(a.inviterID);this.$6.showDialog(function(){b("ZenonPreCallHookBuilderHelper").startCall(c.$2,{existingCall:null,invitees:[a.inviterID].concat(a.participants.filter(function(a){return a!==b("CurrentUser").getAccountID()})),mediaType:a.requestingVideo?"video":"audio",thread:d,trigger:"blue_missed_call_dialog"}),b("ZenonUserActionLogger").logClick({component:"call_back",surface:"missed_call_dialog"})});b("ZenonUserActionLogger").logImpression({surface:"missed_call_dialog"})}};return a}();e.exports=a}),null);